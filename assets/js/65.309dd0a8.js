(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{432:function(s,t,a){"use strict";a.r(t);var e=a(17),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"sophon-miner-快速启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sophon-miner-快速启动"}},[s._v("#")]),s._v(" "),a("code",[s._v("sophon-miner")]),s._v(" 快速启动")]),s._v(" "),a("h2",{attrs:{id:"实例初始化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例初始化"}},[s._v("#")]),s._v(" 实例初始化")]),s._v(" "),a("h3",{attrs:{id:"初始化-repo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初始化-repo"}},[s._v("#")]),s._v(" 初始化 "),a("code",[s._v("Repo")])]),s._v(" "),a("p",[a("strong",[s._v("注意⚠️")])]),s._v(" "),a("ol",[a("li",[a("code",[s._v("init")]),s._v(" 命令会连接 "),a("code",[s._v("--api")]),s._v("flag 指定的链节点,所以必须先启动链节点，才能初始化成功。")])]),s._v(" "),a("p",[a("code",[s._v("< v1.7.0")]),s._v(" 版本:")]),s._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ ./sophon-miner init\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# For nettype, choose from mainnet, debug, 2k, calibnet")]),s._v("\n--nettype"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("calibnet "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--auth-api"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("http://VENUS_AUTH_IP:PORT"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--token"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("SHARED_ADMIN_AUTH_TOKEN"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--gateway-api"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("VENUS_GATEWAY_IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/tcp/PORT "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--api"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("VENUS_DAEMON_IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/tcp/PORT "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--slash-filter "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n")])])]),a("p",[a("code",[s._v(">= v1.7.0")]),s._v(" 版本:")]),s._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ ./sophon-miner init\n--api"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("VENUS_DAEMON_IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/tcp/PORT "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--gateway-api"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("VENUS_GATEWAY_IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/tcp/PORT "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--auth-api "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("http://VENUS_AUTH_IP:PORT"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--token "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("SHARED_ADMIN_AUTH_TOKEN"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--slash-filter "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n")])])]),a("h3",{attrs:{id:"启动-sophon-miner"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动-sophon-miner"}},[s._v("#")]),s._v(" 启动 "),a("code",[s._v("sophon-miner")])]),s._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("nohup")]),s._v(" ./sophon-miner run "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" miner.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("&1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n")])])]),a("h2",{attrs:{id:"矿工管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#矿工管理"}},[s._v("#")]),s._v(" 矿工管理")]),s._v(" "),a("p",[a("code",[s._v("sophon-miner")]),s._v(" 启动时会从 "),a("code",[s._v("sophon-auth")]),s._v(" 中拉取矿工列表，然后预执行一遍出块流程，如果失败可用 "),a("code",[s._v("state")]),s._v(" 命令查看原因：")]),s._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ ./sophon-miner address state\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Addr"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"<MINER_ID>"')]),s._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IsMining"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true,\n\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Err"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),a("p",[s._v("查看当前的矿工列表：")]),s._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ ./sophon-miner address list\n")])])]),a("p",[a("code",[s._v("start")]),s._v(" 或 "),a("code",[s._v("stop")]),s._v(" 命令可以开始或暂停某个矿工的的出块流程，如暂停 "),a("code",[s._v("f01008")]),s._v(" 的出块流程：")]),s._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ ./sophon-miner address stop f01008\n")])])]),a("blockquote",[a("p",[s._v("注意：暂停后即使矿工有算力也不会执行出块，故在故障修复后需执行 "),a("code",[s._v("start")]),s._v(" 开启出块流程。")])]),s._v(" "),a("p",[s._v("有矿工加入或退出矿池,或矿工信息有变化时,需要重新从"),a("code",[s._v("venus_auth")]),s._v("拉取矿工列表：")]),s._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ ./sophon-miner address update\n")])])]),a("h2",{attrs:{id:"出块权统计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#出块权统计"}},[s._v("#")]),s._v(" 出块权统计")]),s._v(" "),a("p",[s._v("统计矿工在指定链高度区间内获得的出块权：")]),s._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("./sophon-miner winner count --epoch-start"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("START_EPOCH"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --epoch-end"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("END_EPOCH"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("MINER_ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),a("blockquote",[a("p",[s._v("这个是统计历史出块权的，不是预测未来的，所以： 1. "),a("code",[s._v("epoch-end")]),s._v(" > "),a("code",[s._v("epoch-start")]),s._v("; 2. "),a("code",[s._v("epoch-end")]),s._v(" 须小于当前链高度。")])])])}),[],!1,null,null,null);t.default=r.exports}}]);